# **智能代理設計模式常見問題**

## 1. 什麼是「智能代理設計模式」？

智能代理設計模式是建構智慧型自主系統 (智能代理) 時常見問題的可重複使用、高層次解決方案。這些模式為設計智能代理行為提供了結構化框架，就像軟體設計模式為傳統程式設計所做的一樣。它們幫助開發者建構更穩健、可預測且有效的 AI 智能代理。

## 2. 本指南的主要目標是什麼？

本指南旨在提供設計和建構智能代理系統的實用、實戰介紹。它超越理論討論，提供具體的架構藍圖，開發者可以使用這些藍圖以可靠的方式建立能夠進行複雜、目標導向行為的智能代理。

## 3. 本指南的目標讀者是誰？

本指南專為使用大語言模型 (LLM) 和其他 AI 元件建構應用程式的 AI 開發者、軟體工程師和系統架構師而撰寫。它適合那些希望從簡單的提示-回應互動轉向建立複雜自主智能代理的人。

## 4. 討論的一些關鍵智能代理模式有哪些？

根據目錄，本指南涵蓋了幾個關鍵模式，包括：

- **反思：** 智能代理批評自身行動和輸出以改善效能的能力。  
- **規劃：** 將複雜目標分解為較小、可管理步驟或任務的過程。  
- **工具使用：** 智能代理利用外部工具 (如程式碼解釋器、搜尋引擎或其他 API) 來獲取資訊或執行它自己無法做到的行動的模式。  
- **多智能代理協作：** 讓多個專業智能代理協同解決問題的架構，通常涉及「領導者」或「編排者」智能代理。  
- **人在迴路中：** 整合人類監督和干預，允許對智能代理的行動進行回饋、修正和核准。

## 5. 為什麼「規劃」是一個重要模式？

規劃很關鍵，因為它允許智能代理處理無法用單一行動解決的複雜多步驟任務。通過建立計劃，智能代理可以維持連貫的策略、追蹤其進度，並以結構化方式處理錯誤或意外障礙。這防止智能代理「卡住」或偏離使用者的最終目標。

## 6. 對智能代理來說，「工具」和「技能」之間有什麼區別？

雖然這些術語經常互換使用，但「工具」通常指智能代理可以呼叫的外部資源 (例如天氣 API、計算器)。「技能」是智能代理已學會的更整合的能力，通常結合工具使用與內部推理來執行特定功能 (例如「預訂機票」的技能可能涉及使用日曆和航空公司 API)。

## 7. 「反思」模式如何改善智能代理的效能？

反思充當一種自我修正形式。在生成回應或完成任務後，智能代理可以被提示檢視其工作、檢查錯誤、根據某些標準評估其品質，或考慮替代方法。這種反覆改進過程幫助智能代理產生更準確、相關且高品質的結果。

## 8. 反思模式的核心理念是什麼？

反思模式給予智能代理退後並批評自己工作的能力。智能代理不是一次性產生最終輸出，而是生成草稿，然後對其進行「反思」，識別缺陷、遺漏資訊或需要改進的領域。這種自我修正過程是提高其回應品質和準確性的關鍵。

## 9. 為什麼簡單的「提示詞鏈」不足以產生高品質輸出？

簡單的提示詞鏈 (其中一個提示的輸出成為下一個提示的輸入) 往往過於基礎。模型可能只是重新表述其先前的輸出，而沒有真正改善它。真正的反思模式需要更結構化的批評，提示智能代理根據特定標準分析其工作、檢查邏輯錯誤或驗證事實。

## 10. 本章提到的兩種主要反思類型是什麼？

本章討論了兩種主要的反思形式：

- **「檢查你的工作」反思：** 這是一種基本形式，智能代理只是被要求檢視和修正其先前的輸出。這是發現簡單錯誤的良好起點。  
- **「內部批評者」反思：** 這是一種更進階的形式，使用單獨的「批評者」智能代理 (或專用提示) 來評估「工作者」智能代理的輸出。這個批評者可以被給予要尋找的特定標準，導致更嚴格和針對性的改進。

## 11. 反思如何幫助減少「幻覺」？

通過提示智能代理檢視其工作，特別是通過將其陳述與已知來源比較或檢查其自己的推理步驟，反思模式可以顯著減少幻覺 (編造事實) 的可能性。智能代理被迫更加基於提供的上下文，較不可能生成無根據的資訊。

## 12. 反思模式可以應用多於一次嗎？

是的，反思可以是一個反覆過程。智能代理可以被要求對其工作進行多次反思，每次迴圈進一步改進輸出。這對於複雜任務特別有用，其中第一次或第二次嘗試可能仍包含細微錯誤或可以大幅改進。

## 13. 在 AI 智能代理背景下，規劃模式是什麼？

規劃模式涉及使智能代理能夠將複雜的高層目標分解為一系列較小的可執行步驟。智能代理不是試圖一次解決大問題，而是首先建立一個「計劃」，然後執行計劃中的每個步驟，這是一種更可靠的方法。

## 14. 為什麼複雜任務需要規劃？

大語言模型在需要多個步驟或依賴性的任務上可能會有困難。沒有計劃，智能代理可能會失去對整體目標的追蹤、錯過關鍵步驟，或無法將一個步驟的輸出作為下一個步驟的輸入。計劃提供了清晰的路線圖，確保原始要求的所有需求以邏輯順序得到滿足。

## 15. 實作規劃模式的常見方式是什麼？

常見的實作是讓智能代理首先以結構化格式 (如 JSON 陣列或編號清單) 生成步驟清單。系統然後可以遍歷這個清單，逐一執行每個步驟，並將結果回饋給智能代理以告知下一個行動。

## 16. 智能代理如何處理執行期間的錯誤或變化？

穩健的規劃模式允許動態調整。如果一個步驟失敗或情況發生變化，智能代理可以被提示從當前狀態「重新規劃」。它可以分析錯誤、修改剩餘步驟，或甚至添加新步驟來克服障礙。

## 17. 使用者會看到計劃嗎？

這是一個設計選擇。在許多情況下，首先向使用者展示計劃以獲得核准是一個很好的做法。這與「人在迴路中」模式一致，在執行智能代理提議的行動之前，給予使用者透明度和控制權。

## 18. 「工具使用」模式包含什麼？

工具使用模式允許智能代理通過與外部軟體或 API 互動來擴展其能力。由於大語言模型的知識是靜態的，它無法自己執行真實世界的行動，工具給它提供了即時資訊的存取 (例如 Google 搜尋)、專有資料 (例如公司的資料庫) 或執行行動的能力 (例如發送電子郵件、預訂會議)。

## 19. 智能代理如何決定使用哪個工具？

智能代理通常被給予可用工具的清單，以及每個工具功能和所需參數的描述。當面對它無法用內部知識處理的要求時，智能代理的推理能力允許它從清單中選擇最適當的工具來完成任務。

## 20. 在這個背景下提到的「ReAct」(推理與行動) 框架是什麼？

ReAct 是一個流行的框架，整合了推理和行動。智能代理遵循 **思考** (推理它需要做什麼)、**行動** (決定使用哪個工具以及使用什麼輸入) 和 **觀察** (查看工具的結果) 的迴圈。這個迴圈持續進行，直到它收集到足夠的資訊來滿足使用者的要求。

## 21. 實作工具使用的一些挑戰是什麼？

關鍵挑戰包括：

- **錯誤處理：** 工具可能失敗、回傳意外資料或逾時。智能代理需要能夠識別這些錯誤並決定是否重試、使用不同的工具或向使用者尋求幫助。  
- **安全性：** 給予智能代理工具存取權限，特別是那些執行行動的工具，具有安全性影響。對敏感操作設置防護措施、權限和通常的人類核准是至關重要的。  
- **提示：** 智能代理必須被有效提示以生成正確格式的工具呼叫 (例如正確的函數名稱和參數)。

## 22. 什麼是人在迴路中 (HITL) 模式？

HITL 是一種將人類監督和互動整合到智能代理工作流程中的模式。智能代理不是完全自主的，而是在關鍵節點暫停以尋求人類回饋、核准、澄清或指導。

## 23. 為什麼 HITL 對智能代理系統很重要？

出於幾個原因，它很關鍵：

- **安全性和控制：** 對於高風險任務 (例如金融交易、發送官方通訊)，HITL 確保人類在執行智能代理提議的行動之前進行驗證。  
- **改善品質：** 人類可以提供修正或細緻的回饋，智能代理可以用來改善其效能，特別是在主觀或模糊的任務中。  
- **建立信任：** 使用者更可能信任和採用他們可以指導和監督的 AI 系統。

## 24. 在工作流程的哪些點應該包含人類？

人類干預的常見點包括：

- **計劃核准：** 在執行多步驟計劃之前。  
- **工具使用確認：** 在使用具有真實世界後果或花費金錢的工具之前。  
- **歧義解決：** 當智能代理不確定如何進行或需要來自使用者的更多資訊時。  
- **最終輸出檢閱：** 在將最終結果交付給最終使用者或系統之前。

## 25. 持續的人類干預不是沒有效率嗎？

可能是，這就是為什麼關鍵是找到正確的平衡。HITL 應該在關鍵檢查點實作，而不是每個單一行動。目標是在人類和智能代理之間建立協作夥伴關係，其中智能代理處理大部分工作，人類提供戰略指導。

## 26. 什麼是多智能代理協作模式？

這種模式涉及建立一個由多個專業智能代理組成的系統，它們協同工作以實現共同目標。不是讓一個「通才」智能代理試圖做所有事情，而是建立一個「專家」智能代理團隊，每個都有特定的角色或專業知識。

## 27. 多智能代理系統的好處是什麼？

- **模組化和專業化：** 每個智能代理可以為其特定任務進行微調和提示 (例如「研究者」智能代理、「寫作者」智能代理、「程式碼」智能代理)，導致更高品質的結果。  
- **降低複雜性：** 將複雜工作流程分解為專業角色使整個系統更容易設計、除錯和維護。  
- **模擬腦力激盪：** 不同的智能代理可以對問題提供不同的觀點，導致更有創意和穩健的解決方案，類似於人類團隊的工作方式。

## 28. 多智能代理系統的常見架構是什麼？

常見架構涉及 **編排者智能代理** (有時稱為「管理者」或「指揮者」)。編排者理解整體目標，將其分解，並將子任務委派給適當的專家智能代理。然後它從專家那裡收集結果並將它們綜合成最終輸出。

## 智能代理如何彼此溝通？

溝通通常由編排者管理。例如，編排者可能將「研究者」智能代理的輸出作為上下文傳遞給「寫作者」智能代理。智能代理可以發布其發現的共享「草稿本」或訊息匯流排是另一種常見的溝通方法。

## 為什麼評估智能代理比評估傳統軟體程式更困難？

傳統軟體具有確定性輸出 (相同的輸入總是產生相同的輸出)。智能代理，特別是那些使用大語言模型的，是非確定性的，它們的效能可能是主觀的。評估它們需要評估其輸出的*品質*和*相關性*，而不僅僅是它是否在技術上「正確」。

## 評估智能代理效能的一些常見方法是什麼？

本指南建議幾種方法：

- **基於結果的評估：** 智能代理是否成功實現了最終目標？例如，如果任務是「預訂機票」，是否確實正確預訂了機票？這是最重要的衡量標準。  
- **基於過程的評估：** 智能代理的*過程*是否高效且合邏輯？它是否使用了正確的工具？它是否遵循了合理的計劃？這有助於除錯智能代理可能失敗的原因。  
- **人類評估：** 讓人類根據有用性、準確性和連貫性等標準，在量表上 (例如 1-5) 為智能代理的效能評分。這對於面向使用者的應用程式至關重要。

## 什麼是「智能代理軌跡」？

智能代理軌跡是智能代理在執行任務時完整步驟的紀錄。它包括所有的想法、行動 (工具呼叫) 和觀察。分析這些軌跡是除錯和理解智能代理行為的關鍵部分。

## 如何為非確定性系統建立可靠的測試？

雖然你無法保證智能代理輸出的確切用詞，但你可以建立檢查關鍵元素的測試。例如，你可以撰寫測試來驗證智能代理的最終回應是否*包含*特定資訊，或它是否成功以正確參數呼叫了某個工具。這通常在專用測試環境中使用模擬工具來完成。

## 提示智能代理與簡單的 ChatGPT 提示有何不同？

提示智能代理涉及建立詳細的「系統提示」或章程，作為其操作指令。這超越了單一使用者查詢；它定義了智能代理的角色、可用工具、應該遵循的模式 (如 ReAct 或規劃)、其約束條件和個性。

## 智能代理良好系統提示的關鍵元件是什麼？

強大的系統提示通常包括：

- **角色和目標：** 清楚定義智能代理是誰以及其主要目的是什麼。  
- **工具定義：** 可用工具的清單、其描述以及如何使用它們 (例如以特定的函數呼叫格式)。  
- **約束條件和規則：** 關於智能代理*不應該*做什麼的明確指令 (例如「未經核准不要使用工具」、「不要提供財務建議」)。  
- **過程指令：** 關於使用哪些模式的指導。例如「首先，建立一個計劃。然後，逐步執行計劃。」  
- **範例軌跡：** 提供一些成功的「思考-行動-觀察」迴圈範例可以顯著改善智能代理的可靠性。

## 什麼是「提示洩漏」？

提示洩漏發生在系統提示的部分 (如工具定義或內部指令) 在智能代理對使用者的最終回應中意外洩露時。這可能會讓使用者感到困惑並暴露底層實作細節。使用單獨的推理提示和生成最終答案的提示等技術可以幫助防止這種情況。

## 智能代理系統的一些未來趨勢是什麼？

本指南指向一個具有以下特點的未來：

- **更自主的智能代理：** 需要較少人類干預且能夠自主學習和適應的智能代理。  
- **高度專業化的智能代理：** 可以為特定任務 (例如旅行智能代理、研究智能代理) 聘用或訂閱的智能代理生態系統。  
- **更好的工具和平台：** 開發更複雜的框架和平台，使建構、測試和部署穩健的多智能代理系統變得更容易。